minimalcarbon code
November 7 2022 

minimalcarbon.site is a pipeline of programs, mostly written in python 3.10.

After trying out several other apps (httrack, wget,...) and WordPress Plugins (simply static, WP2Static, Export WP Page to Static HTML/CSS, Staatic, Static HTML Output,..) I decided to start from scratch, since none of these apps was fit for the task or easily adaptable.

Description of the pipeline:
+ intermediate results are stored in csv files
+ all python code: ca 9000 lines [find . -maxdepth 1 -name '*.py' | xargs wc -l]

apps:

app_050_sitemap_crawl: 20min

	+ crawl, extract all connected internal and external links from given URL
	

app_150_selenium: 1h
	
	+ save all files locally with headless browser
		https://en.wikipedia.org/wiki/Headless_browser
		 they are able to render and understand HTML the same way a browser would, including styling elements such as page layout, colour, font selection and execution of JavaScript and Ajax which are usually not available.
	+ extract all links
	+ change all links so they refer to root /
	+ serve thsi website locally via LAMP, xampp, etc
	+ find all real image sizes in webpage on standard desktop browser
	+ extract all image- and backround-image-links from html and save locally
	
now come methods that are also site-specific to karlsruhe.digital 	
	
app_200_images: 1h30
	+ copy favicon
	+ append css to style.css
	+ append special javascript
	+ download fonts or remove all font tags
	+ remove fonts from stylesheets
	+ replace fonts in tag styles 
	+ perform_pdf_compression
	+ perform_image_conversion to webp or avif, resize, color grade via lut, ...
	+ replace all conversions in files
	+ create sitemap.xml
	+ minify all css, html and js files
	+ special fixes like minimal carbon banner, percentage saved, etc
	+ remove unneeded scripts
	+ remove undesired elements like twitter etc
	+ create banner
	+ calculate difference of sizes
	+ export optimized site
	
next steps:
now would come a refactoring:
	+ dividing the code and tasks into more dedicated individual apps
	+ divide apps for general and for specific use
	
	
	
	
	
	